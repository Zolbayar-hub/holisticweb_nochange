<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bio Energy healer and Sound Therapy- Heal Your Mind, Body & Spirit</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <!-- Header with Navigation -->
    <header class="header">
        <nav class="nav-container">
            <a href="#" class="logo">
                <div class="logo-image">
                    <img src="{{ url_for('static', filename='images/logo1.png') }}" alt="Serenity Wellness Logo" style="width: 100%; height: 100%; object-fit: contain;">
                </div>
                <div class="logo-text">
                    <span class="main-text">SERENITY</span>
                    <span class="sub-text">WELLNESS Studio</span>
                </div>
            </a>
            
            <!-- Desktop Navigation -->
            <ul class="desktop-nav">
                <li><a href="#home">Home</a></li>
                <li><a href="#services">Services</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="{{ url_for('blog.index') }}">Blog</a></li>
                <li><a href="#contact">Contact</a></li>
                <li><a href="{{ url_for('booking.booking_page') }}">Book Now</a></li>
                <li><a href="{{ url_for('booking.my_bookings') }}">My Bookings</a></li>
                {% if current_user.is_authenticated and current_user.role.name == 'admin' %}
                <li><a href="{{ url_for('web_admin_panel.web_admin_panel') }}" style="color: #ffc107;">Admin</a></li>
                {% endif %}
                <li class="language-switcher">
                    <select onchange="switchLanguage(this.value)" style="background: #2c5530; color: white; border: 1px solid #4a7c59; border-radius: 4px; padding: 4px 8px;">
                        <option value="ENG" {% if current_language == 'ENG' %}selected{% endif %}>English</option>
                        <option value="MON" {% if current_language == 'MON' %}selected{% endif %}>–ú–æ–Ω–≥–æ–ª</option>
                    </select>
                </li>
                <li><button id="desktop-auth-btn" class="auth-btn">Login</button></li>
            </ul>
            
            <!-- Mobile Hamburger Button -->
            <button class="hamburger" id="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </button>
            
            <!-- Mobile Menu Dropdown -->
            <div class="mobile-menu" id="mobile-menu">
                <ul>
                    <li><a href="#home">Home</a></li>
                    <li><a href="#services">Services</a></li>
                    <li><a href="#about">About</a></li>
                    <li><a href="{{ url_for('blog.index') }}">Blog</a></li>
                    <li><a href="#contact">Contact</a></li>
                    <li><a href="{{ url_for('booking.booking_page') }}">Book Now</a></li>
                    <li><a href="{{ url_for('booking.my_bookings') }}">My Bookings</a></li>
                    {% if current_user.is_authenticated and current_user.role.name == 'admin' %}
                    <li><a href="{{ url_for('web_admin_panel.web_admin_panel') }}" style="color: #ffc107;">Admin Panel</a></li>
                    {% endif %}
                    <li class="mobile-language-switcher">
                        <label style="color: white; font-size: 0.9rem; display: block; margin-bottom: 0.5rem;">Language:</label>
                        <select onchange="switchLanguage(this.value)" style="background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.3); border-radius: 4px; padding: 8px 12px; width: 100%; font-size: 1rem;">
                            <option value="ENG" {% if current_language == 'ENG' %}selected{% endif %}>English</option>
                            <option value="MON" {% if current_language == 'MON' %}selected{% endif %}>–ú–æ–Ω–≥–æ–ª</option>
                        </select>
                    </li>
                </ul>
                <button id="mobile-auth-btn" class="auth-btn">Login</button>
            </div>
        </nav>
    </header>
    
    <!-- Hidden containers for auth.js compatibility -->
    <div id="login-btn-container" style="display: none;"></div>
    <div id="login-btn-sidebar" style="display: none;"></div>
    <div id="content-login-btn-container" style="display: none;"></div>
    
    <!-- Main Content -->
    <main class="main-content">
        <!-- Hero Section -->
        <section class="hero" id="home" style="position: relative; overflow: hidden; min-height: 100vh; display: flex; align-items: center;">
            <img id="hero-image" 
                 src="{{ url_for('static', filename=settings.get('home_image', 'images/main_page_images/meditating_woman.jpg')) }}" 
                 alt="Hero Background" 
                 style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: -2;"
                 onerror="console.error('Hero image failed to load:', this.src); this.src='{{ url_for('static', filename='images/main_page_images/meditating_woman.jpg') }}';">
            <!-- Debug: Current home_image setting = {{ settings.get('home_image', 'NOT SET') }} -->
            <!-- Debug: Language = {{ current_language }} -->
            
            <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(rgba(102, 126, 234, 0.3), rgba(118, 75, 162, 0.3)); z-index: -1;"></div>
            <div class="hero-content" style="text-align: center !important; position: relative; z-index: 1; width: 100%;">
                <h1>{{ settings.get('hero_title', 'Bio Energy Healer and Sound Therapy') }}</h1>
                <p style="text-align: center !important; margin: 0 auto;">{{ settings.get('hero_subtitle', 'Discover the power of integrated healing for your mind, body, and spirit. Our comprehensive approach combines traditional wisdom with modern techniques to help you achieve optimal wellness.') }}</p>
                <a href="#services" class="cta-button">Explore Our Services</a>
                <a href="{{ url_for('booking.booking_page') }}" class="cta-button" style="margin-left: 15px;">Book Now</a>
            </div>
        </section>
        
        <!-- Services Section -->
        <section class="services" id="services">
            <div class="container">
                <h2 class="section-title">Our Therapeutic Services</h2>
                <div class="services-carousel">
                    <button class="carousel-btn carousel-btn-prev" id="carousel-prev">&lt;</button>
                    <div class="services-container">
                        <div class="services-grid" id="services-grid">
                            {% for service in services %}
                            <div class="service-card">
                                {% if service.image_path %}
                                <div class="service-image">
                                    <img src="{{ url_for('static', filename=service.image_path) }}" alt="{{ service.name }}">
                                </div>
                                {% else %}
                                <div class="service-icon">üßò‚Äç‚ôÄÔ∏è</div>
                                {% endif %}
                                <h3>{{ service.name }}</h3>
                                <p>{{ service.description }}</p>
                                <p><strong>Duration:</strong> {{ service.duration }} min</p>
                                <p><strong>Price:</strong> ${{ '%.2f'|format(service.price) }}</p>
                                <a href="{{ url_for('booking.booking_page') }}" class="service-book-btn">Book This Service</a>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    <button class="carousel-btn carousel-btn-next" id="carousel-next">&gt;</button>
                </div>
            </div>
        </section>
        
        <!-- About Section -->
        <section class="about" id="about">
            <div class="container">
                <div class="about-content">
                    <div class="about-text">
                        <h2>{{ settings.get('about_title', 'Our Holistic Approach') }}</h2>
                        <p>{{ settings.get('about_text_1', 'At Holistic Therapy, we believe that true healing encompasses all aspects of the human experience. Our integrated approach addresses the interconnected nature of mind, body, and spirit.') }}</p>
                        <p>{{ settings.get('about_text_2', 'Our experienced practitioners work with you to create personalized treatment plans that honor your unique journey and support your natural healing processes.') }}</p>
                        <p>{{ settings.get('about_text_3', 'Whether you\'re seeking relief from stress, looking to improve your overall wellness, or embarking on a journey of personal growth, we\'re here to support you every step of the way.') }}</p>
                    </div>
                    <div class="about-image">
                        <div class="about-carousel-wrapper">
                            <div class="about-carousel">
                                {% if about_images %}
                                    {% for image in about_images %}
                                    <div class="about-slide{% if loop.first %} active{% endif %}">
                                        {% if image.media_type == 'video' %}
                                        <video autoplay muted style="width: 100%; height: 100%; object-fit: cover;" 
                                               data-video-slide="true">
                                            <source src="{{ url_for('static', filename=image.image_path) }}" type="video/mp4">
                                            Your browser does not support the video tag.
                                        </video>
                                        {% else %}
                                        <img src="{{ url_for('static', filename=image.image_path) }}" alt="{{ image.title }}" style="width: 100%; height: 100%; object-fit: cover;">
                                        {% endif %}
                                        <div class="about-slide-caption">{{ image.caption }}</div>
                                    </div>
                                    {% endfor %}
                                {% else %}
                                <!-- Fallback images if none in database -->
                                <div class="about-slide active">
                                    <img src="{{ url_for('static', filename='images/about_images/1.jpg') }}" alt="Peaceful meditation environment" style="width: 100%; height: 100%; object-fit: cover;">
                                    <div class="about-slide-caption">üåü Your Healing Journey Starts Here üåü</div>
                                </div>
                                <div class="about-slide">
                                    <img src="{{ url_for('static', filename='images/about_images/2.jpg') }}" alt="Natural healing environment" style="width: 100%; height: 100%; object-fit: cover;">
                                    <div class="about-slide-caption">üåø Connect with Nature's Energy üåø</div>
                                </div>
                                <div class="about-slide">
                                    <img src="{{ url_for('static', filename='images/about_images/3.jpg') }}" alt="Tranquil therapeutic space" style="width: 100%; height: 100%; object-fit: cover;">
                                    <div class="about-slide-caption">‚ú® Experience Inner Peace ‚ú®</div>
                                </div>
                                <div class="about-slide">
                                    <img src="{{ url_for('static', filename='images/about_images/4.jpg') }}" alt="Test image" style="width: 100%; height: 100%; object-fit: cover;">
                                    <div class="about-slide-caption">üîÆ Discover Your Potential üîÆ</div>
                                </div>
                                {% endif %}
                            </div>
                            
                            <!-- Navigation Buttons -->
                            <button class="about-carousel-btn about-carousel-prev" id="about-prev">&lt;</button>
                            <button class="about-carousel-btn about-carousel-next" id="about-next">&gt;</button>
                            
                            <!-- Dots Indicator -->
                            <div class="about-carousel-dots">
                                {% if about_images %}
                                    {% for image in about_images %}
                                    <span class="about-dot{% if loop.first %} active{% endif %}" data-slide="{{ loop.index0 }}"></span>
                                    {% endfor %}
                                {% else %}
                                <!-- Fallback dots if no images in database -->
                                <span class="about-dot active" data-slide="0"></span>
                                <span class="about-dot" data-slide="1"></span>
                                <span class="about-dot" data-slide="2"></span>
                                <span class="about-dot" data-slide="3"></span>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Testimonials Section -->
        <section class="testimonials" id="testimonials">
            <div class="container">
                <h2 class="section-title">What Our Clients Say</h2>
                <p style="text-align: center; margin-bottom: 30px;">
                    <button id="open-testimonial-btn" class="cta-button" style="font-size: 0.9rem; padding: 10px 20px; border: none; cursor: pointer;">
                        Share Your Experience
                    </button>
                </p>
                <div class="testimonials-carousel">
                    <div class="testimonials-container">
                        <div class="testimonials-grid" id="testimonials-grid">
                            {% for testimonial in testimonials %}
                            <div class="testimonial-card">
                                <div class="testimonial-content">
                                    <div class="stars">{{ testimonial.get_star_display() }}</div>
                                    <p>"{{ testimonial.testimonial_text }}"</p>
                                    <div class="testimonial-author">
                                        <h4>{{ testimonial.client_name }}</h4>
                                        {% if testimonial.client_title %}
                                        <span>{{ testimonial.client_title }}</span>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            {% else %}
                            <!-- Fallback testimonials if none in database -->
                            <div class="testimonial-card">
                                <div class="testimonial-content">
                                    <div class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                                    <p>"The holistic approach here has completely transformed my life. I came in feeling stressed and overwhelmed, but now I feel balanced and at peace. The practitioners truly care about your whole well-being."</p>
                                    <div class="testimonial-author">
                                        <h4>Sarah Johnson</h4>
                                        <span>Marketing Executive</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="testimonial-card">
                                <div class="testimonial-content">
                                    <div class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                                    <p>"I've tried many different therapies over the years, but nothing compares to the integrated healing approach here. The combination of mind, body, and spirit work has been life-changing."</p>
                                    <div class="testimonial-author">
                                        <h4>Michael Chen</h4>
                                        <span>Software Engineer</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="testimonial-card">
                                <div class="testimonial-content">
                                    <div class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                                    <p>"After struggling with anxiety for years, I finally found relief through the personalized treatment plan they created for me. The practitioners are knowledgeable, compassionate, and truly gifted."</p>
                                    <div class="testimonial-author">
                                        <h4>Emily Rodriguez</h4>
                                        <span>Teacher</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="testimonial-card">
                                <div class="testimonial-content">
                                    <div class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                                    <p>"The healing environment here is unlike anywhere else. From the moment you walk in, you feel the positive energy. My sessions have helped me reconnect with myself and find inner peace."</p>
                                    <div class="testimonial-author">
                                        <h4>David Thompson</h4>
                                        <span>Artist</span>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    
                    <!-- Navigation Buttons -->
                    <button class="testimonial-carousel-btn testimonial-carousel-prev" id="testimonial-prev">&lt;</button>
                    <button class="testimonial-carousel-btn testimonial-carousel-next" id="testimonial-next">&gt;</button>
                </div>
            </div>
        </section>
        
        <!-- Contact Section -->
        <section class="contact" id="contact">
            <div class="container">
                <div class="contact-content">
                    <h2 class="section-title">{{ settings.get('contact_title', 'Begin Your Healing Journey') }}</h2>
                    <p>{{ settings.get('contact_text', 'Ready to take the first step? Contact us to schedule a consultation and discover how our holistic approach can support your wellness goals.') }}</p>
                    
                    <form class="contact-form" method="POST" action="{{ url_for('main.contact_form') }}">
                        <input type="text" name="name" placeholder="Your Name" required>
                        <input type="email" name="email" placeholder="Your Email" required>
                        <input type="tel" name="phone" placeholder="Your Phone">
                        <textarea name="message" rows="5" placeholder="Tell us about your wellness goals and how we can help you..." required></textarea>
                        <button type="submit">Send Message</button>
                    </form>
                    
                    {% if settings.get('business_phone') or settings.get('business_email') or settings.get('business_address') %}
                    <div class="contact-info mt-4">
                        {% if settings.get('business_phone') %}
                        <p><strong>Phone:</strong> {{ settings.get('business_phone') }}</p>
                        {% endif %}
                        {% if settings.get('business_email') %}
                        <p><strong>Email:</strong> {{ settings.get('business_email') }}</p>
                        {% endif %}
                        {% if settings.get('business_address') %}
                        <p><strong>Address:</strong> {{ settings.get('business_address') }}</p>
                        {% endif %}
                    </div>
                    {% endif %}
                </div>
            </div>
        </section>
    </main>
    
    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 {{ settings.get('footer_text', 'Bio Energy Healer and Sound Therapy. All rights reserved. | Healing Mind, Body & Spirit') }}</p>
        </div>
    </footer>
    
    <!-- JavaScript -->
    <script src="{{ url_for('static', filename='auth.js') }}"></script>
    <script src="{{ url_for('static', filename='home.js') }}"></script>
    <script>
        function switchLanguage(language) {
            // Redirect to the same page with the language parameter
            const currentUrl = new URL(window.location);
            currentUrl.searchParams.set('lang', language);
            window.location.href = currentUrl.toString();
        }
        
        // Video handling for about carousel
        document.addEventListener('DOMContentLoaded', function() {
            const aboutCarousel = document.querySelector('.about-carousel');
            if (aboutCarousel) {
                let aboutCarouselInstance = null;
                let videoPlayCount = new Map(); // Track video play cycles
                
                // Get the carousel instance from home.js
                setTimeout(() => {
                    // Find the AboutImageCarousel instance
                    if (window.aboutCarouselInstance) {
                        aboutCarouselInstance = window.aboutCarouselInstance;
                        console.log('üé† Found carousel instance');
                    }
                }, 200);
                
                // Handle video slides differently
                const observer = new MutationObserver(function(mutations) {
                    mutations.forEach(function(mutation) {
                        if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                            const slide = mutation.target;
                            const video = slide.querySelector('video[data-video-slide]');
                            
                            if (video) {
                                if (slide.classList.contains('active')) {
                                    console.log('üé¨ Video slide became active');
                                    
                                    // Pause carousel auto-advance
                                    if (aboutCarouselInstance && typeof aboutCarouselInstance.pauseAutoSlide === 'function') {
                                        aboutCarouselInstance.pauseAutoSlide();
                                        console.log('‚è∏Ô∏è Carousel auto-advance paused for video');
                                    }
                                    
                                    // Reset video play count for this video
                                    videoPlayCount.set(video, 0);
                                    
                                    // Reset video to beginning and play
                                    video.currentTime = 0;
                                    video.play().then(() => {
                                        console.log('‚úÖ Video started playing');
                                    }).catch(e => {
                                        console.log('‚ö†Ô∏è Video autoplay prevented:', e);
                                    });
                                    
                                } else {
                                    console.log('‚è∏Ô∏è Video slide became inactive');
                                    video.pause();
                                    video.currentTime = 0;
                                    videoPlayCount.delete(video);
                                }
                            } else if (slide.classList.contains('active')) {
                                // Regular image slide - ensure auto-advance is running
                                if (aboutCarouselInstance && typeof aboutCarouselInstance.startAutoSlide === 'function') {
                                    aboutCarouselInstance.startAutoSlide();
                                    console.log('‚ñ∂Ô∏è Carousel auto-advance resumed for image');
                                }
                            }
                        }
                    });
                });
                
                // Observe all slides for class changes
                const slides = aboutCarousel.querySelectorAll('.about-slide');
                slides.forEach(slide => {
                    observer.observe(slide, { attributes: true, attributeFilter: ['class'] });
                    
                    // Initialize videos
                    const video = slide.querySelector('video[data-video-slide]');
                    if (video) {
                        // Add event listeners for video debugging
                        video.addEventListener('loadeddata', function() {
                            console.log('üìπ Video loaded, duration:', this.duration, 'seconds');
                        });
                        
                        video.addEventListener('loadedmetadata', function() {
                            console.log('üìä Video metadata loaded, dimensions:', this.videoWidth, 'x', this.videoHeight);
                        });
                        
                        video.addEventListener('play', function() {
                            console.log('‚ñ∂Ô∏è Video started playing');
                        });
                        
                        video.addEventListener('pause', function() {
                            console.log('‚è∏Ô∏è Video paused');
                        });
                        
                        video.addEventListener('ended', function() {
                            const currentCount = videoPlayCount.get(this) || 0;
                            const newCount = currentCount + 1;
                            videoPlayCount.set(this, newCount);
                            
                            console.log('üîÑ Video ended, play count:', newCount);
                            
                            // After video plays once, advance to next slide
                            if (newCount >= 1) {
                                console.log('‚úÖ Video played once, advancing carousel...');
                                setTimeout(() => {
                                    if (aboutCarouselInstance && typeof aboutCarouselInstance.nextSlide === 'function') {
                                        aboutCarouselInstance.nextSlide();
                                        aboutCarouselInstance.startAutoSlide();
                                    }
                                }, 1000); // Wait 1 second before advancing
                            }
                        });
                        
                        video.addEventListener('error', function(e) {
                            console.error('‚ùå Video error:', e);
                        });
                        
                        // If this slide is currently active, start the video
                        if (slide.classList.contains('active')) {
                            video.currentTime = 0;
                            videoPlayCount.set(video, 0);
                            video.play().catch(e => console.log('Video autoplay prevented:', e));
                        }
                    }
                });
            }
        });
        
        // Header scroll effect for transparency
        window.addEventListener('scroll', function() {
            const header = document.querySelector('.header');
            if (window.scrollY > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });
    </script>
    
    <!-- Modal for inline testimonial submission -->
    <div id="testimonial-modal" class="modal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); z-index:1000;">
        <div class="modal-dialog" style="max-width:900px; width:calc(100% - 2rem); margin:2rem auto; background:white; padding:1.25rem; border-radius:8px; position:relative; box-sizing:border-box; max-height:calc(100vh - 4rem); overflow-y:auto;">
            <button id="close-testimonial-modal" style="position:absolute; right:12px; top:12px; background:none; border:none; font-size:1.25rem; cursor:pointer;">&times;</button>
            <h2 style="margin-top:0;">Share Your Experience</h2>
            <p>We would love to hear about your healing journey with us. Your testimonial will be published immediately.</p>
            {% with messages = get_flashed_messages(with_categories=true) %}
              {% if messages %}
                {% for category, message in messages %}
                  <div class="alert alert-{{ 'danger' if category == 'error' else 'success' if category == 'success' else category }}">
                    {{ message }}
                  </div>
                {% endfor %}
              {% endif %}
            {% endwith %}

            <form method="POST" action="{{ url_for('testimonials.submit_testimonial') }}" class="testimonial-form">
                <div class="form-group">
                    <label for="client_name_modal">Your Name *</label>
                    <input type="text" id="client_name_modal" name="client_name" required placeholder="Enter your full name" style="width:100%; box-sizing:border-box;">
                </div>
                <div class="form-group">
                    <label for="client_title_modal">Your Title/Profession</label>
                    <input type="text" id="client_title_modal" name="client_title" placeholder="e.g., Teacher, Marketing Executive (optional)" style="width:100%; box-sizing:border-box;">
                </div>
                <div class="form-group">
                    <label for="email_modal">Your Email</label>
                    <input type="email" id="email_modal" name="email" placeholder="your.email@example.com (optional)" style="width:100%; box-sizing:border-box;">
                </div>
                <div class="form-group">
                    <label for="rating_modal">Rating *</label>
                    <div class="rating-input">
                        <input type="radio" id="m_star5" name="rating" value="5" checked>
                        <label for="m_star5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</label>
                        <input type="radio" id="m_star4" name="rating" value="4">
                        <label for="m_star4">‚≠ê‚≠ê‚≠ê‚≠ê</label>
                        <input type="radio" id="m_star3" name="rating" value="3">
                        <label for="m_star3">‚≠ê‚≠ê‚≠ê</label>
                        <input type="radio" id="m_star2" name="rating" value="2">
                        <label for="m_star2">‚≠ê‚≠ê</label>
                        <input type="radio" id="m_star1" name="rating" value="1">
                        <label for="m_star1">‚≠ê</label>
                    </div>
                </div>
                <div class="form-group">
                    <label for="testimonial_text_modal">Your Experience *</label>
                    <textarea id="testimonial_text_modal" name="testimonial_text" rows="6" required placeholder="Please share your experience with our holistic therapy services." style="width:100%; box-sizing:border-box; min-height:120px;"></textarea>
                </div>
                <div class="form-group" style="display:flex; gap:8px; align-items:center;">
                    <button type="submit" class="submit-btn">Submit Testimonial</button>
                    <button type="button" id="cancel-testimonial-modal" class="cancel-btn">Cancel</button>
                </div>
                <p class="form-note"><small>* Required fields. Your testimonial will be published immediately on the site after submission.</small></p>
            </form>
        </div>
    </div>

    <script>
    // Testimonial modal open/close
    (function(){
        const openBtn = document.getElementById('open-testimonial-btn');
        const modal = document.getElementById('testimonial-modal');
        const closeBtn = document.getElementById('close-testimonial-modal');
        const cancelBtn = document.getElementById('cancel-testimonial-modal');

        if (!openBtn || !modal) return;

        function openModal(){
            modal.style.display = 'block';
            // prevent background scroll
            document.body.style.overflow = 'hidden';
            const firstInput = modal.querySelector('input, textarea');
            if (firstInput) firstInput.focus();
        }
        function closeModal(){
            modal.style.display = 'none';
            // restore background scroll
            document.body.style.overflow = '';
        }
        openBtn.addEventListener('click', openModal);
        if (closeBtn) closeBtn.addEventListener('click', closeModal);
        if (cancelBtn) cancelBtn.addEventListener('click', closeModal);

        // Close when clicking outside dialog
        modal.addEventListener('click', function(e){
            if (e.target === modal) closeModal();
        });

        // Allow ESC to close
        document.addEventListener('keydown', function(e){
            if (e.key === 'Escape' && modal.style.display === 'block') closeModal();
        });
    })();
    </script>
</body>
</html>
